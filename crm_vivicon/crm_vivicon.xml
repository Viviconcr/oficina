<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record model="ir.ui.view" id="crm_lead_view_form_vivicon">
        <field name="name">crm.lead.view.form.vivicon</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_lead_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//div[@class='oe_title']" position="attributes">
                <attribute name="invisible">True</attribute>
            </xpath>
            <field name="user_id" position="replace">
            </field>        
            <field name="expected_revenue" position="replace">
                <field name="expected_revenue" invisible="1"/>
            </field>        
            <field name="probability" position="replace">
                <field name="probability" invisible="1"/>
            </field>
            <xpath expr="//group[@name='opportunity_partner']/field[@name='partner_id']" position="replace">
                <field name="partner_id" invisible="1"/>
                <h2>Contacto</h2>
                <field name="name" string="Nombre"/>
            </xpath>        
            <xpath expr="//group[@name='opportunity_partner']" position="inside">
                <field name="metodo_contacto"/>
                <field name="user_id" string="Asesor"/>
            </xpath>        

            <field name="date_deadline" position="replace">
                <field name="date_deadline" invisible="1"/>
            </field>        
            <field name="priority" position="replace">
                <field name="priority" invisible="1"/>
            </field>        
            <field name="team_id" position="replace">
                <field name="team_id" invisible="1"/>
            </field>        
            <field name="tag_ids" position="replace">
                <h2>Contacto Relacionado</h2>
                <field name="contact_name" id="contact_name_page_lead" string="Nombre"/>
                <field name="function" string="Correo electrónico"/>
                <field name="mobile" id="mobile_page_lead" string="Teléfono" widget="phone"/>
                <field name="modelo_interes" widget="many2many_tags" options="{'no_create': True}"/>
            </field>   
            <page name="extra" position="replace"/>
            <page name="lead" position="replace"/>
            <!--page name="internal_notes" position="attributes">
                <attribute name="string">Actividades y Notas</attribute>
            </page-->
            <page name="internal_notes" position="replace">
                <page string="Origen" name="origen">
<!--attrs="{'invisible': ['|','|',('stage_id', '&lt;', 1),('stage_id', '=', 2),('stage_id', '=', 3)]}"-->
                    <group string="Origen de Oportunidad">
                        <group>
                            <field name="source_id" string="Cómo nos contactó?"/>
                            <field name="campaign_id" string="Lugar primer contacto"/>
                            <field name="medium_id" string="Medio"/>
                        </group>
                    </group>
                </page>
                <page string="Calificación" name="calificacion">
                    <group>
                        <group >
                            <field name="plazo_decidir"/>
                            <field name="interes_disposicion"/>
                            <field name="capacidad_economica"/>
                        </group>
                        <group >
                            <field name="calificacion"/>
                            <field name="frecuencia_seguimiento"/>
                        </group>
                    </group>
                </page>
                <page string="Reserva" name="reserva">
<!--attrs="{'invisible': ['|',('stage_id', '=', 1),('stage_id', '=', 2)]}"-->
                    <group name="reserva_general">
                        <group >
                            <field name="fecha_posible"/>
                            <field name="fecha_reserva"/>
                            <field name="metodo_pago"/>
                        </group>
                        <group >
                            <field name="numero_comprobante"/>
                            <field name="monto_pago"/>
                        </group>
                    </group>
                </page>
                <page string="Negociación" name="negociacion">
                    <group>
                        <field name="negociacion_solicitada" attrs="{'readonly': [('negociacion_aprobada','=',True)]}"/>
                        <field name="negociacion_aprobada"/>
                        <field name="negociacion_ids"
                                widget="section_and_note_one2many"
                                mode="tree"
                                attrs="{'readonly': [('negociacion_aprobada','=',True)]}">
                            <tree editable="bottom" string="Negociaciones">
                                <field name="tipo_negociacion"/>
                                <field name="descripcion"/>
                                <field name="monto"/>
                            </tree>
                        </field>
                    </group>
                </page>
                <page string="Documentos" name="documentos" attrs="{'invisible': [('stage_id', '&lt;', 3)]}">
                    <group string="Requisitos" name="reserva_requisitos">
                        <group>
                            <field name="req_copia_cedula"/>
                            <field name="req_conozca_cliente"/>
                        </group>
                        <group>
                            <field name="req_hoja_datos_propiedad"/>
                        </group>
                    </group>
                </page>
                <page string="Contrato" name="contrato" attrs="{'invisible': [('stage_id', '&lt;', 4)]}">
                    <group string="Requisitos">
                        <group>
                            <field name="req_cumple_firma_contrato"/>
                        </group>
                    </group>
                </page>
                <page string="Formalización" name="formalizacion" attrs="{'invisible': [('stage_id', '&lt;', 5)]}">
                    <group string="Formalización">
                        <group>
                            <!--field name="req_fecha_contrato_listo"/-->
                            <field name="req_fecha_formalizacion"/>
                        </group>
                    </group>
                </page>
            </page>
        </field>
    </record>
    <!--record model="ir.ui.view" id="crm_lead_view_form_vivicon_agents">
        <field name="name">crm.lead.view.form.vivicon</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm_vivicon.crm_lead_view_form_vivicon"/>
        <field name="groups_id" eval="[(6, 0, [ref('base.group_user') ])]" />                
        <field name="arch" type="xml">
            <field name="negociacion_aprobada" position="attributes">
                <attribute name="readonly">1</attribute>                   
            </field>                             
        </field>
    </record>
    <record model="ir.ui.view" id="crm_lead_view_form_vivicon_managers">
        <field name="name">crm.lead.view.form.vivicon</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm_vivicon.crm_lead_view_form_vivicon"/>
        <field name="groups_id" eval="[(6, 0, [ref('sales_team.group_sale_manager') ])]" />                
        <field name="arch" type="xml">
            <field name="negociacion_aprobada" position="attributes">
                <attribute name="readonly">0</attribute>                   
            </field>                             
        </field>
    </record-->

    <record id="res_config_settings_view_form_vivicon" model="ir.ui.view">
        <field name="name">res.config.settings.view.form.inherit.crm.vivicon</field>
        <field name="model">res.config.settings</field>
        <field name="priority" eval="5"/>
        <field name="inherit_id" ref="crm.res_config_settings_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//div[hasclass('app_settings_block')]" position="after">
                <div class="app_settings_block" data-string="CRM-VIVICON" string="CRM-VIVICON" data-key="crm" groups="sales_team.group_sale_manager">
                    <h2>CRM - VIVICON</h2>
                    <div class="row mt16 o_settings_container" name="vivicon_setting_container">
                        <div class="col-12 col-lg-6 o_setting_box" id="crm_vivicon"
                            title="Permitir la aprobación de negociaciones.">
                            <div class="o_setting_left_pane">
                                <field name="group_aprobar_negociaciones"/>
                            </div>
                            <div class="o_setting_right_pane">
                                <label for="group_use_lead"/>
                                <div class="text-muted">
                                    Aprobar negociaciones
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </xpath>
        </field>
    </record>



</odoo>


