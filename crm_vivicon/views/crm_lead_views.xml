<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record model="ir.ui.view" id="crm_case_kanban_view_leads_vivicon">
        <field name="name">crm.case.kanban.view.leads.vivicon</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_kanban_view_leads"/>
        <field name="groups_id" eval="[(6, 0, [ref('sales_team.group_sale_salesman') ])]" />                
        <field name="arch" type="xml">
            <xpath expr="//kanban" position="attributes">
                <attribute name="quick_create">0</attribute>
                <attribute name="records_draggable">0</attribute>
            </xpath>
            <progressbar field="activity_state" position="replace"/>
        </field>        
    </record>        

    <record model="ir.ui.view" id="crm_case_kanban_view_leads_vivicon_manager">
        <field name="name">crm.case.kanban.view.leads.vivicon.manager</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm_case_kanban_view_leads_vivicon"/>
        <field name="groups_id" eval="[(6, 0, [ref('sales_team.group_sale_manager') ])]" />                
        <field name="arch" type="xml">
            <xpath expr="//kanban" position="attributes">
                <attribute name="quick_create">1</attribute>
            </xpath>
        </field>        
    </record>        

    <record model="ir.ui.view" id="crm_lead_view_kanban_vivicon">
        <field name="name">crm.lead.view.kanban.vivicon</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.quick_create_opportunity_form"/>
        <field name="arch" type="xml">
            <field name="partner_id" position="replace">
                <field name="partner_id" invisible="1"/>
            </field>        
            <field name="expected_revenue" position="replace">
                <field name="expected_revenue" invisible="1"/>
            </field>        
            <field name="priority" position="replace">
                <field name="priority" invisible="1"/>
            </field>        
            <field name="name" position="attributes">
                <attribute name="string">Nombre Completo</attribute>
            </field>
            <field name="phone" position="after">
                <field name="modelo_interes" widget="many2many_tags" options="{'no_create': True}"/>
            </field>        
            <xpath expr="//label" position="replace">
            </xpath>
        </field>        
    </record>        

    <record model="ir.ui.view" id="crm_lead_view_form_vivicon">
        <field name="name">crm.lead.view.form.vivicon</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_lead_view_form"/>
        <field name="arch" type="xml">
            <button name="action_set_won_rainbowman" position="attributes">
                <attribute name="invisible">True</attribute>
            </button>
            <field name="stage_id" position="attributes">
                <attribute name="options">{'clickable': 0}</attribute>
            </field>
            <xpath expr="//div[@class='oe_title']" position="attributes">
                <attribute name="invisible">True</attribute>
            </xpath>

            <field name="user_id" position="replace">
            </field>

            <field name="expected_revenue" position="replace">
                <field name="expected_revenue" invisible="1"/>
            </field>        
            <field name="probability" position="replace">
                <field name="probability" invisible="1"/>
            </field>
            <xpath expr="//group[@name='opportunity_partner']/field[@name='partner_id']" position="replace">
                <field name="partner_id" invisible="1"/>
                <h2>Prospecto</h2>
                <field name="name" string="Nombre Completo"/>
                <field name="stage_sequence" invisible="1"/>
            </xpath>

            <xpath expr="//group[@name='opportunity_partner']/label[@for='phone']" position="replace">
                <label for="phone" string="Celular" class="oe_inline"/>
            </xpath>            

            <xpath expr="//group[@name='opportunity_partner']/div[2]" position="after">
                <field name="other_phone"/>
            </xpath>
            <xpath expr="//group[@name='opportunity_partner']" position="inside">
                <field name="metodo_contacto" attrs="{'required': True}"/>
                <field name="crm_project_id" string="Proyecto de Interés" options="{'no_create': True}"/>
                <field name="modelo_interes" widget="many2many_tags" options="{'no_create': True}"/>
                <field name="user_id" string="Asesor" readonly="1"/>
            </xpath>        

            <field name="date_deadline" position="replace">
                <field name="date_deadline" invisible="1"/>
            </field>        
            <field name="priority" position="replace">
                <field name="priority" invisible="1"/>
            </field>        
            <field name="team_id" position="replace">
                <field name="team_id" invisible="1"/>
            </field>        
            <field name="tag_ids" position="replace">
                <h2>Contacto Relacionado</h2>
                <field name="contact_name" id="contact_name_page_lead" string="Nombre"/>
                <field name="function" string="Correo electrónico"/>
                <field name="mobile" id="mobile_page_lead" string="Teléfono" widget="phone"/>
                <label for="es_similar_a_otro" string="Posible Duplicación" />
                <div class="d-flex">
                    <field name="es_similar_a_otro" attrs="{'readonly':1}" />
                    <span class="o_form_label mx-3">      Similares </span>
                    <field name="cantidad_similares" attrs="{'readonly': 1}" />
                </div>
                <field name="similar_autorizado_por" string="Autoriza Similar" attrs="{'invisible':[('similar_autorizado_por','=',False)]}" />
            </field>   
            <page name="extra" position="replace"/>
            <page name="lead" position="replace"/>
            <!--page name="internal_notes" position="attributes">
                <attribute name="string">Actividades y Notas</attribute>
            </page-->
            <page name="internal_notes" position="replace">
                <page string="Origen" name="origen">
<!--attrs="{'invisible': ['|','|',('stage_id', '&lt;', 1),('stage_id', '=', 2),('stage_id', '=', 3)]}"-->
                    <group string="Origen de Oportunidad">
                        <group>
                            <field name="source_id" string="Cómo nos contactó?"/>
                            <field name="campaign_id" string="Lugar primer contacto"/>
                            <field name="medium_id" string="Cómo se enteró del proyecto?"/>
                        </group>
                    </group>
                </page>
                <page string="Leads Similares" name="Leads Similares"  attrs="{'invisible': [('cantidad_similares', '&lt;=', 0)]}" >
                    <group string="Leads Similares">
                        <field name="lead_similares_ids" nolabel="1">
                            <tree create="false" delete="false">
                                <field name="lead_similar_id" widget="many2one_clickable" options="{'no_create': True, 'no_create_edit': True}"/>
                                <field name="nombre" />
                                <field name="email_from" />
                                <field name="telefono" />
                                <field name="modelo_interes" widget="many2many_tags" />
                            </tree>
                        </field>
                    </group>
                </page>
                <page string="Calificación" name="calificacion">
                    <group>
                        <group >
                            <field name="plazo_decidir"/>
                            <field name="interes_disposicion"/>
                            <field name="capacidad_economica"/>
                        </group>
                        <group >
                            <field name="calificacion"/>
                            <field name="frecuencia_seguimiento"/>
                        </group>
                    </group>
                </page>
                <page string="Reserva" name="reserva">
<!--attrs="{'invisible': ['|',('stage_id', '=', 1),('stage_id', '=', 2)]}"-->
                    <group name="reserva_general">
                        <group >
                            <field name="fecha_posible" attrs="{'required': [('numero_comprobante', '!=', False)]}"/>
                            <field name="fecha_reserva" attrs="{'required': [('numero_comprobante', '!=', False)]}"/>
                            <field name="metodo_pago" attrs="{'required': [('numero_comprobante', '!=', False)]}"/>
                            <field name="modelo_seleccionado_id"/>
                            <field name="casa_seleccionada_id"
                                domain="[('product_id','in',[modelo_seleccionado_id])]" attrs="{'required': [('numero_comprobante', '!=', False)]}"/>                            
                        </group>
                        <group >
                            <field name="numero_comprobante"/>
                            <field name="moneda" invisible="1"/>
                            <field name="monto_pago" attrs="{'required': [('numero_comprobante', '!=', False)]}"/>
                            <field name="copia_comprobante"/>
                        </group>
                    </group>
                </page>
                <page string="Negociación" name="negociacion" attrs="{'invisible': [('stage_sequence', '&lt;', 3)]}">
                    <group>
                        <field name="negociacion_solicitada" attrs="{'readonly': [('negociacion_aprobada','=',True)]}"/>
                        <field name="negociacion_aprobada" readonly="1"/>
                        <field name="negociacion_ids"
                                widget="section_and_note_one2many"
                                mode="tree"
                                attrs="{'readonly': [('negociacion_aprobada','=',True)]}">
                            <tree editable="bottom" string="Negociaciones">
                                <field name="tipo_negociacion"/>
                                <field name="descripcion"/>
                                <field name="moneda" invisible="1"/>
                                <field name="monto"/>
                            </tree>
                        </field>
                    </group>
                </page>
                <page string="Documentos" name="documentos" attrs="{'invisible': [('stage_sequence', '&lt;', 3)]}">
                    <group string="Requisitos" name="reserva_requisitos">
                        <group>
                            <field name="req_copia_cedula"/>
                            <field name="req_conozca_cliente"/>
                        </group>
                        <group>
                            <field name="req_hoja_datos_propiedad"/>
                        </group>
                    </group>
                </page>
                <page string="Contrato" name="contrato" attrs="{'invisible': [('stage_sequence', '&lt;', 4)]}">
                    <group string="Requisitos">
                        <group>
                            <field name="req_cumple_firma_contrato" readonly="1"/>
                        </group>
                    </group>
                </page>
                <page string="Seguimiento" name="Seguimiento" attrs="{'invisible': [('stage_sequence', '&lt;', 4)]}">
                        <group>
                            <field name="banco" />
                        </group>
                        <group >
                            <field name="observaciones"  placeholder="Observaciones del seguimiento."/>
                        </group>
                    <field name="seguimiento_ids"
                            widget="section_and_note_one2many"
                            mode="tree">
                        <tree editable="bottom" string="Detalle">
                            <field name="fecha"/>
                            <field name="detalle"/>
                        </tree>
                    </field>
                </page>               
                <page string="Formalización" name="formalizacion" attrs="{'invisible': [('stage_sequence', '&lt;', 5)]}">
                    <group string="Formalización">
                        <group>
                            <!--field name="req_fecha_contrato_listo"/-->
                            <field name="req_fecha_formalizacion"/>
                            <field name="entidad_bancaria"/>
                        </group>
                    </group>
                </page>
            </page>
        </field>
    </record>

    <!--record model="ir.ui.view" id="crm_lead_view_form_vivicon_agents">
        <field name="name">crm.lead.view.form.vivicon</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm_vivicon.crm_lead_view_form_vivicon"/>
        <field name="groups_id" eval="[(6, 0, [ref('base.group_user') ])]" />                
        <field name="arch" type="xml">
            <field name="negociacion_aprobada" position="attributes">
                <attribute name="readonly">1</attribute>                   
            </field>                             
        </field>
    </record-->
    <record model="ir.ui.view" id="crm_lead_view_form_vivicon_all_leads">
        <field name="name">crm.lead.view.form.vivicon</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm_vivicon.crm_lead_view_form_vivicon"/>
        <field name="groups_id" eval="[(6, 0, [ref('sales_team.group_sale_salesman_all_leads') ])]" />                
        <field name="arch" type="xml">
            <field name="user_id" position="attributes">
                <attribute name="readonly">0</attribute>                   
            </field>                             
        </field>
    </record>

    <record model="ir.ui.view" id="crm_lead_view_form_vivicon_managers">
        <field name="name">crm.lead.view.form.vivicon</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm_vivicon.crm_lead_view_form_vivicon"/>
        <field name="groups_id" eval="[(6, 0, [ref('sales_team.group_sale_manager') ])]" />                
        <field name="arch" type="xml">
            <field name="es_similar_a_otro" position="attributes">
                <attribute name="readonly">0</attribute>
            </field>
            <field name="negociacion_aprobada" position="attributes">
                <attribute name="readonly">0</attribute>                   
            </field>                             
            <field name="req_cumple_firma_contrato" position="attributes">
                <attribute name="readonly">0</attribute>                   
            </field>                             
        </field>
    </record>

</odoo>

